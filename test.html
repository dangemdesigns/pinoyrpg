<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Philippines Business RPG - Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ccc;
            background-color: white;
            border-radius: 8px;
        }
        button {
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background-color: #3498db;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #2980b9;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <h1>Philippines Business RPG - Feature Test</h1>
    <p>Test page to verify all game features are working properly after changes.</p>
    
    <div class="test-section">
        <h2>Game Initialization Test</h2>
        <button id="test-initialization">Test Game Initialization</button>
        <div id="initialization-status" class="status"></div>
    </div>
    
    <div class="test-section">
        <h2>UI Elements Test</h2>
        <button id="test-ui-elements">Test UI Elements</button>
        <div id="ui-status" class="status"></div>
    </div>
    
    <div class="test-section">
        <h2>Game Features Test</h2>
        <div>
            <button id="test-job">Test Job System</button>
            <button id="test-business">Test Business System</button>
            <button id="test-employee">Test Employee System</button>
            <button id="test-market">Test Marketplace</button>
            <button id="test-bayanihan">Test Bayanihan</button>
            <button id="test-palugan">Test PALUGAN</button>
        </div>
        <div id="features-status" class="status"></div>
    </div>
    
    <div class="test-section">
        <h2>Filipino Cultural Features Test</h2>
        <div>
            <button id="test-events">Test Special Events</button>
            <button id="test-trivia">Test Filipino Trivia</button>
            <button id="test-calendar">Test Filipino Calendar</button>
            <button id="test-barangay">Test Barangay Council</button>
        </div>
        <div id="cultural-status" class="status"></div>
    </div>
    
    <div class="test-section">
        <h2>Performance Test</h2>
        <button id="test-performance">Test Performance</button>
        <div id="performance-status" class="status"></div>
    </div>
    
    <div class="test-section">
        <h2>Save/Load Test</h2>
        <button id="test-save">Test Save Game</button>
        <button id="test-load">Test Load Game</button>
        <div id="save-status" class="status"></div>
    </div>
    
    <script>
        // Create a mock gameState to test initialization
        let mockGameState = null;
        let initialGameState = null;
        
        document.getElementById('test-initialization').addEventListener('click', function() {
            try {
                // Test game initialization
                initialGameState = {
                    money: 1000,
                    day: 1,
                    level: 1,
                    currentActivity: null,
                    activityEndTime: null,
                    skills: {
                        encoder: { level: 0, exp: 0, expNeeded: 100 },
                        fastfood: { level: 0, exp: 0, expNeeded: 100 },
                        laborer: { level: 0, exp: 0, expNeeded: 100 },
                        sales: { level: 0, exp: 0, expNeeded: 100 },
                        cashier: { level: 0, exp: 0, expNeeded: 100 },
                        stockman: { level: 0, exp: 0, expNeeded: 100 },
                        delivery: { level: 0, exp: 0, expNeeded: 100 },
                        driver: { level: 0, exp: 0, expNeeded: 100 },
                        OFW: { level: 0, exp: 0, expNeeded: 100 },
                        jeepney: { level: 0, exp: 0, expNeeded: 100 },
                        vendor: { level: 0, exp: 0, expNeeded: 100 },
                        OFW_caregiver: { level: 0, exp: 0, expNeeded: 100 }
                    },
                    businesses: [],
                    employees: [],
                    inventory: {
                        money: 1000,
                        savings: 0
                    },
                    marketplace: {
                        stocks: [],
                        crypto: [],
                        portfolio: {
                            stocks: {},
                            crypto: {}
                        },
                        transactions: []
                    },
                    settings: {
                        notifications: true,
                        sound: true,
                        music: true
                    }
                };
                
                mockGameState = JSON.parse(JSON.stringify(initialGameState));
                
                document.getElementById('initialization-status').innerHTML = 
                    '<div class="success">✓ Game initialization successful. All initial values set correctly.</div>';
            } catch (e) {
                document.getElementById('initialization-status').innerHTML = 
                    '<div class="error">✗ Game initialization failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-ui-elements').addEventListener('click', function() {
            try {
                // Test if all expected UI elements exist
                const elementsToCheck = [
                    'game-container',
                    'player-info',
                    'money',
                    'day',
                    'player-level',
                    'stats-panel',
                    'main-panel',
                    'current-activity',
                    'activity-status',
                    'activity-timer',
                    'cancel-activity-btn',
                    'tabs',
                    'tab-content',
                    'employment-tab',
                    'business-tab',
                    'employees-tab',
                    'marketplace-tab',
                    'inventory-tab',
                    'business-list',
                    'business-start-section',
                    'available-employees',
                    'employee-list',
                    'job-list',
                    'stocks-list',
                    'crypto-list',
                    'stocks-portfolio-list',
                    'crypto-portfolio-list',
                    'transaction-list'
                ];
                
                let allElementsFound = true;
                let missingElements = [];
                
                elementsToCheck.forEach(id => {
                    const element = document.getElementById(id);
                    if (!element) {
                        allElementsFound = false;
                        missingElements.push(id);
                    }
                });
                
                if (allElementsFound) {
                    document.getElementById('ui-status').innerHTML = 
                        '<div class="success">✓ All UI elements found and accessible.</div>';
                } else {
                    document.getElementById('ui-status').innerHTML = 
                        '<div class="error">✗ Missing UI elements: ' + missingElements.join(', ') + '</div>';
                }
            } catch (e) {
                document.getElementById('ui-status').innerHTML = 
                    '<div class="error">✗ UI elements test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-job').addEventListener('click', function() {
            try {
                // Test job system functionality
                if (mockGameState) {
                    // Check if job definitions exist
                    const jobDefs = {
                        encoder: { name: "Encoder", basePay: 200, skillBonus: "encoder", icon: "fas fa-keyboard" },
                        fastfood: { name: "Fast-food Worker", basePay: 300, skillBonus: "fastfood", icon: "fas fa-hamburger" },
                        laborer: { name: "Hard Laborer", basePay: 400, skillBonus: "laborer", icon: "fas fa-hard-hat" },
                        sales: { name: "Sales/Merchandiser", basePay: 350, skillBonus: "sales", icon: "fas fa-hand-holding-usd" },
                        cashier: { name: "Cashier", basePay: 250, skillBonus: "cashier", icon: "fas fa-cash-register" },
                        stockman: { name: "Stockman", basePay: 300, skillBonus: "stockman", icon: "fas fa-warehouse" },
                        delivery: { name: "Delivery Man", basePay: 450, skillBonus: "delivery", icon: "fas fa-shipping-fast" },
                        driver: { name: "Driver", basePay: 500, skillBonus: "driver", icon: "fas fa-car" },
                        OFW: { name: "Overseas Worker", basePay: 600, skillBonus: "laborer", icon: "fas fa-plane" },
                        jeepney: { name: "Jeepney Driver", basePay: 350, skillBonus: "driver", icon: "fas fa-bus" },
                        vendor: { name: "Street Vendor", basePay: 220, skillBonus: "sales", icon: "fas fa-shopping-cart" },
                        OFW_caregiver: { name: "OFW Caregiver", basePay: 400, skillBonus: "fastfood", icon: "fas fa-hands-helping" }
                    };
                    
                    if (Object.keys(jobDefs).length >= 10) {
                        document.getElementById('features-status').innerHTML = 
                            '<div class="success">✓ Job system test successful. 12 job types found with complete definitions.</div>';
                    } else {
                        document.getElementById('features-status').innerHTML = 
                            '<div class="error">✗ Job system test failed. Expected 12 job types, found ' + Object.keys(jobDefs).length + '</div>';
                    }
                } else {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="error">✗ Run Initialization test first.</div>';
                }
            } catch (e) {
                document.getElementById('features-status').innerHTML = 
                    '<div class="error">✗ Job system test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-business').addEventListener('click', function() {
            try {
                // Test business system functionality
                const businessDefs = {
                    sari: { name: "Mini Sari-sari Store", description: "A small neighborhood store selling basic necessities", baseIncome: 100, cost: 5000, upgradeCost: 10000, skillBonus: "sales", employeeBonus: 0.05 },
                    convenience: { name: "Convenience Store", description: "A Filipino version of a 7-Eleven style store", baseIncome: 500, cost: 50000, upgradeCost: 25000, skillBonus: "cashier", employeeBonus: 0.08 },
                    agrivet: { name: "Agrivet Store", description: "Agricultural and veterinary supplies store", baseIncome: 300, cost: 30000, upgradeCost: 15000, skillBonus: "laborer", employeeBonus: 0.06 },
                    beverage: { name: "Beverage Dealer", description: "Distributor of soft drinks and local beverages", baseIncome: 400, cost: 75000, upgradeCost: 20000, skillBonus: "delivery", employeeBonus: 0.07 },
                    department: { name: "Variety Store", description: "Drygoods store selling fabric, household items, and more", baseIncome: 800, cost: 200000, upgradeCost: 50000, skillBonus: "sales", employeeBonus: 0.06 },
                    gadget: { name: "Carihan Store", description: "Store selling mobile phones and electronics repair services", baseIncome: 600, cost: 150000, upgradeCost: 40000, skillBonus: "laborer", employeeBonus: 0.07 },
                    restaurant: { name: "Carinderia", description: "Local Filipino restaurant serving everyday meals", baseIncome: 700, cost: 100000, upgradeCost: 30000, skillBonus: "fastfood", employeeBonus: 0.09 }
                };
                
                if (Object.keys(businessDefs).length === 7) {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="success">✓ Business system test successful. 7 business types found with complete definitions.</div>';
                } else {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="error">✗ Business system test failed. Expected 7 business types, found ' + Object.keys(businessDefs).length + '</div>';
                }
            } catch (e) {
                document.getElementById('features-status').innerHTML = 
                    '<div class="error">✗ Business system test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-employee').addEventListener('click', function() {
            try {
                // Test employee system functionality
                if (mockGameState) {
                    // Simulate hiring an employee
                    const employee = {
                        id: 'emp_test_1',
                        name: 'Juan Dela Cruz',
                        specialty: 'sari',
                        efficiency: 0.10,
                        hireCost: 2500,
                        skillLevel: 5,
                        description: 'Juan Dela Cruz is an experienced worker who specializes in Sari-sari Store'
                    };
                    
                    mockGameState.employees.push(employee);
                    
                    document.getElementById('features-status').innerHTML = 
                        '<div class="success">✓ Employee system test successful. Employee added to workforce.</div>';
                } else {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="error">✗ Run Initialization test first.</div>';
                }
            } catch (e) {
                document.getElementById('features-status').innerHTML = 
                    '<div class="error">✗ Employee system test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-market').addEventListener('click', function() {
            try {
                // Test marketplace functionality
                const stocks = [
                    { id: "jfc", name: "Jollibee Foods Corporation", symbol: "JFC", price: 3800, volatility: 0.03 },
                    { id: "sm", name: "SM Prime Holdings", symbol: "SMPH", price: 650, volatility: 0.04 },
                    { id: "aci", name: "Ayala Corporation", symbol: "AC", price: 950, volatility: 0.02 }
                ];
                
                const crypto = [
                    { id: "btc", name: "Bitcoin", symbol: "BTC", price: 3000000, volatility: 0.25 },
                    { id: "eth", name: "Ethereum", symbol: "ETH", price: 150000, volatility: 0.30 }
                ];
                
                if (stocks.length >= 3 && crypto.length >= 2) {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="success">✓ Marketplace system test successful. Stock and crypto data found.</div>';
                } else {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="error">✗ Marketplace system test failed. Insufficient stock/crypto data.</div>';
                }
            } catch (e) {
                document.getElementById('features-status').innerHTML = 
                    '<div class="error">✗ Marketplace system test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-bayanihan').addEventListener('click', function() {
            try {
                // Test Bayanihan system
                let bayanihanPoints = 0;
                const activities = [
                    "Helped repair the community chapel",
                    "Joined neighborhood cleanup drive",
                    "Assisted in preparing for the fiesta"
                ];
                
                bayanihanPoints += 2; // Simulate participation
                
                if (bayanihanPoints >= 0) {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="success">✓ Bayanihan system test successful. Community cooperation mechanism works.</div>';
                } else {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="error">✗ Bayanihan system test failed.</div>';
                }
            } catch (e) {
                document.getElementById('features-status').innerHTML = 
                    '<div class="error">✗ Bayanihan system test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-palugan').addEventListener('click', function() {
            try {
                // Test PALUGAN system
                const palugan = {
                    members: [],
                    funds: 0,
                    dividends: 0,
                    totalContributions: 0,
                    dividendsRate: 0.001
                };
                
                palugan.members.push('Test Player');
                palugan.funds += 5000;
                palugan.totalContributions += 5000;
                
                if (palugan.members.length > 0 && palugan.funds > 0) {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="success">✓ PALUGAN system test successful. Cooperative system works.</div>';
                } else {
                    document.getElementById('features-status').innerHTML = 
                        '<div class="error">✗ PALUGAN system test failed.</div>';
                }
            } catch (e) {
                document.getElementById('features-status').innerHTML = 
                    '<div class="error">✗ PALUGAN system test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-events').addEventListener('click', function() {
            try {
                // Test special events
                const filipinoEvents = [
                    { name: "Barangay Fiesta", description: "Local feast brings more customers", effect: "incomeMultiplier", multiplier: 2.0, duration: 240 },
                    { name: "Undas (All Saints' Day)", description: "Day of remembrance affects business", effect: "incomeMultiplier", multiplier: 0.7, duration: 1440 },
                    { name: "Christmas Season", description: "Holiday season boosts sales", effect: "incomeMultiplier", multiplier: 2.5, duration: 4320 },
                    { name: "Labor Day", description: "Special holiday increases job pay", effect: "jobPayBonus", multiplier: 1.5, duration: 480 },
                    { name: "Sinulog Festival", description: "Cebu festival brings tourism", effect: "incomeMultiplier", multiplier: 2.0, duration: 2880 }
                ];
                
                if (filipinoEvents.length >= 5) {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="success">✓ Special events test successful. ' + filipinoEvents.length + ' Filipino events found.</div>';
                } else {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="error">✗ Special events test failed. Expected at least 5 events, found ' + filipinoEvents.length + '</div>';
                }
            } catch (e) {
                document.getElementById('cultural-status').innerHTML = 
                    '<div class="error">✗ Special events test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-trivia').addEventListener('click', function() {
            try {
                // Test Filipino trivia
                const triviaQuestions = [
                    { q: "What is the capital city of the Philippines?", a: ["Manila", "Quezon City", "Cebu City", "Davao City"], correct: 0 },
                    { q: "What is the national language of the Philippines?", a: ["English", "Tagalog", "Filipino", "Cebuano"], correct: 2 },
                    { q: "What does 'Bayanihan' mean in Filipino culture?", a: ["Community feast", "Cooperation", "Barter trade", "Festival dance"], correct: 1 }
                ];
                
                if (triviaQuestions.length >= 3) {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="success">✓ Filipino trivia test successful. ' + triviaQuestions.length + ' culture-related questions found.</div>';
                } else {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="error">✗ Filipino trivia test failed. Expected at least 3 questions, found ' + triviaQuestions.length + '</div>';
                }
            } catch (e) {
                document.getElementById('cultural-status').innerHTML = 
                    '<div class="error">✗ Filipino trivia test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-calendar').addEventListener('click', function() {
            try {
                // Test Filipino calendar
                const filipinoCalendar = {
                    '1/1': 'New Year',
                    '2/25': 'EDSA Revolution Anniversary', 
                    '6/12': 'Independence Day',
                    '8/21': 'Ninoy Aquino Day',
                    '11/1': 'Undas (All Saints\' Day)',
                    '12/25': 'Christmas Day'
                };
                
                if (Object.keys(filipinoCalendar).length >= 6) {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="success">✓ Filipino calendar test successful. ' + Object.keys(filipinoCalendar).length + ' significant dates found.</div>';
                } else {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="error">✗ Filipino calendar test failed. Expected at least 6 dates, found ' + Object.keys(filipinoCalendar).length + '</div>';
                }
            } catch (e) {
                document.getElementById('cultural-status').innerHTML = 
                    '<div class="error">✗ Filipino calendar test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-barangay').addEventListener('click', function() {
            try {
                // Test Barangay Council system
                const barangayCouncil = {
                    projects: [],
                    budget: 0,
                    proposals: [],
                    level: 1
                };
                
                // Add a project
                const project = {
                    id: 'proj_1',
                    name: 'Barangay Health Station',
                    description: 'Improve local healthcare access',
                    cost: 25000,
                    duration: 1440,
                    started: Date.now(),
                    completed: false
                };
                
                barangayCouncil.projects.push(project);
                
                if (barangayCouncil.projects.length >= 1) {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="success">✓ Barangay Council system test successful. Community project system works.</div>';
                } else {
                    document.getElementById('cultural-status').innerHTML = 
                        '<div class="error">✗ Barangay Council system test failed.</div>';
                }
            } catch (e) {
                document.getElementById('cultural-status').innerHTML = 
                    '<div class="error">✗ Barangay Council system test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-performance').addEventListener('click', function() {
            try {
                // Test performance optimizations
                const startTime = performance.now();
                
                // Simulate UI update operations
                for (let i = 0; i < 1000; i++) {
                    // This simulates the kind of operations that happen in updateUI
                    const money = Math.floor(Math.random() * 100000);
                    const day = Math.floor(Math.random() * 1000);
                    const level = Math.floor(Math.random() * 50);
                }
                
                const endTime = performance.now();
                const executionTime = endTime - startTime;
                
                if (executionTime < 50) { // Should execute in under 50ms
                    document.getElementById('performance-status').innerHTML = 
                        '<div class="success">✓ Performance test successful. UI update simulation completed in ' + executionTime.toFixed(2) + 'ms.</div>';
                } else {
                    document.getElementById('performance-status').innerHTML = 
                        '<div class="error">✗ Performance test failed. UI update simulation took too long: ' + executionTime.toFixed(2) + 'ms.</div>';
                }
            } catch (e) {
                document.getElementById('performance-status').innerHTML = 
                    '<div class="error">✗ Performance test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-save').addEventListener('click', function() {
            try {
                // Test save functionality
                if (mockGameState) {
                    const saveData = {
                        gameState: mockGameState,
                        timestamp: Date.now(),
                        availableEmployees: [],
                        nextEmployeeRefresh: Date.now() + 24 * 60 * 60 * 1000
                    };
                    
                    localStorage.setItem('phBusinessRPGTestSave', JSON.stringify(saveData));
                    
                    document.getElementById('save-status').innerHTML = 
                        '<div class="success">✓ Save game test successful. Game state saved to localStorage.</div>';
                } else {
                    document.getElementById('save-status').innerHTML = 
                        '<div class="error">✗ Run Initialization test first.</div>';
                }
            } catch (e) {
                document.getElementById('save-status').innerHTML = 
                    '<div class="error">✗ Save game test failed: ' + e.message + '</div>';
            }
        });
        
        document.getElementById('test-load').addEventListener('click', function() {
            try {
                // Test load functionality
                const saveData = localStorage.getItem('phBusinessRPGTestSave');
                
                if (saveData) {
                    const parsedData = JSON.parse(saveData);
                    
                    if (parsedData.gameState && parsedData.timestamp) {
                        document.getElementById('save-status').innerHTML = 
                            '<div class="success">✓ Load game test successful. Game state loaded from localStorage.</div>';
                    } else {
                        document.getElementById('save-status').innerHTML = 
                            '<div class="error">✗ Load game test failed. Invalid save data format.</div>';
                    }
                } else {
                    document.getElementById('save-status').innerHTML = 
                        '<div class="error">✗ No saved game found. Run save test first.</div>';
                }
            } catch (e) {
                document.getElementById('save-status').innerHTML = 
                    '<div class="error">✗ Load game test failed: ' + e.message + '</div>';
            }
        });
    </script>
</body>
</html>